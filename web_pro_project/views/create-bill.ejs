<%- include("head", { Title: "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•" }) %>
<body>
    <div class="container">
        <h2>üßæ ‡πÅ‡∏à‡πâ‡∏á‡∏ö‡∏¥‡∏•‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>
        <form action="/create-bill" method="POST">
            <div class="mb-3">
                <label for="customer_id" class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                <select class="form-control" id="customer_id" name="customer_id" required>
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ --</option>
                    <% customers.forEach(customer => { %>
                        <option value="<%= customer.customer_id %>">
                            <%= customer.first_name %> <%= customer.last_name %>
                        </option>
                    <% }); %>
                </select>
            </div>

            <div class="mb-3">
                <label for="treatment_id" class="form-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</label>
                <select class="form-control" id="treatment_id" name="treatment_id" required>
                    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤ --</option>
                    <% treatments.forEach(treatment => { %>
                        <option value="<%= treatment.treatment_id %>" data-details="<%= treatment.treatment_details %>">
                            <%= treatment.treatment_details %> (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <%= treatment.treatment_date %>)
                        </option>
                    <% }); %>
                </select>
            </div>

            <div class="mb-3">
                <label for="treatment_details" class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</label>
                <input type="text" class="form-control" id="treatment_details" name="treatment_details" readonly>
            </div>

            <div class="mb-3">
                <label for="amount" class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ø)</label>
                <input type="number" class="form-control" id="amount" name="amount" step="0.01" required>
            </div>

            <button type="submit" class="btn btn-success">üì© ‡πÅ‡∏à‡πâ‡∏á‡∏ö‡∏¥‡∏•</button>
            <a href="/" class="btn btn-secondary">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        </form>
    </div>

    <script>
        document.getElementById("treatment_id").addEventListener("change", function() {
            let selectedOption = this.options[this.selectedIndex];
            document.getElementById("treatment_details").value = selectedOption.getAttribute("data-details");
        });
    </script>
</body>
